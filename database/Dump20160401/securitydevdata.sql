CREATE DATABASE  IF NOT EXISTS `security` /*!40100 DEFAULT CHARACTER SET utf8 */;
USE `security`;
-- MySQL dump 10.13  Distrib 5.7.9, for Win64 (x86_64)
--
-- Host: ec2-52-48-101-197.eu-west-1.compute.amazonaws.com    Database: security
-- ------------------------------------------------------
-- Server version	5.5.46-0ubuntu0.14.04.2

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `access_token`
--

DROP TABLE IF EXISTS `access_token`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `access_token` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `organization_id` int(11) NOT NULL,
  `userid` int(11) NOT NULL,
  `token` varchar(100) NOT NULL,
  `fromdate` datetime NOT NULL,
  `todate` datetime NOT NULL,
  PRIMARY KEY (`id`),
  KEY `accto_fk1_idx` (`organization_id`),
  KEY `accto_fk2_idx` (`userid`),
  KEY `accto_token_idx` (`token`),
  CONSTRAINT `accto_fk1` FOREIGN KEY (`organization_id`) REFERENCES `subscription`.`organization` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `accto_fk2` FOREIGN KEY (`userid`) REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=209 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `access_token`
--

LOCK TABLES `access_token` WRITE;
/*!40000 ALTER TABLE `access_token` DISABLE KEYS */;
INSERT INTO `access_token` VALUES (69,2,2,'admin|DERRY|a0dccf4df1f2fb6b395b3576194e2cd6','2016-02-10 01:28:52','2016-02-11 01:28:52'),(74,2,2,'admin|Derry|1881f7d1afb1a93cd6748fe2b99fecd1','2016-02-11 04:03:26','2016-02-12 04:03:26'),(85,2,2,'Admin|Derry|cb7ecc20e93bae546b63db6179e61661','2016-02-12 09:52:18','2016-02-13 09:52:18'),(93,2,2,'admin|DERRY|6275766838e02c26a01098df10efe0a0','2016-02-14 05:01:00','2016-02-15 05:01:00'),(97,2,2,'Admin|Derry|5b4d12d493e6b1fa32e3ccb72a68f281','2016-02-15 09:48:49','2016-02-16 09:48:49'),(105,6,76,'mbloxham|Amersham|95123fef931c00b7f5d79b9221fdf543','2016-02-16 12:00:45','2016-02-17 12:00:45'),(107,6,73,'apercival|Amersham|2ec1ea1c379e031fd1bb9c680a07899d','2016-02-16 12:16:40','2016-02-17 12:16:40'),(108,6,77,'lblue|Amersham|0760b2acba9615c980fb745eb667a9ba','2016-02-16 12:27:36','2016-02-17 12:27:36'),(109,2,2,'admin|derry|b2b9ff58decda2dee4baa38a364be3c1','2016-02-17 06:05:39','2016-02-18 06:05:39'),(112,6,73,'apercival|Amersham|f73f0ae99274320a3756e3d7479bbac6','2016-02-17 12:25:02','2016-02-18 12:25:02'),(113,6,77,'Lblue|Amersham|4fdc0e32b9f9a556e84dd40672a89c7c','2016-02-17 13:58:22','2016-02-18 13:58:22'),(114,6,78,'mdluser|Amersham|b1086567e3a8b84139f457ffe40b4c57','2016-02-17 15:08:58','2016-02-18 15:08:58'),(115,6,76,'mbloxham|Amersham|f9c80bf9950383d6f5bf73a6e6313a3e','2016-02-17 15:49:52','2016-02-18 15:49:52'),(116,6,73,'apercival|Amersham|e154b44f93097a87a48bf0da1a3bdf07','2016-02-18 12:25:23','2016-02-19 12:25:23'),(117,6,77,'lblue|Amersham|d85a3d39bf34894a23806da0e64d8d77','2016-02-18 13:59:37','2016-02-19 13:59:37'),(118,6,78,'MDLuser|Amersham|c3596f5b6d3ad7fd530dd2f88dff285e','2016-02-18 15:45:27','2016-02-19 15:45:27'),(119,6,76,'mbloxham|amersham|330ef9741ccd072f4842ae88324c9c0e','2016-02-18 15:50:18','2016-02-19 15:50:18'),(120,2,2,'Admin|Derry|a645ef4abdc657c131d4df02affb9e6c','2016-02-22 14:10:16','2016-02-23 14:10:16'),(121,6,78,'mdluser|Amersham|b1d65d67354204fc1be21797d053e332','2016-02-22 14:14:02','2016-02-23 14:14:02'),(122,6,73,'apercival|Amersham|c40b1e84d66cafc90e2a7f4f5e85350d','2016-02-22 15:55:05','2016-02-23 15:55:05'),(123,6,78,'mdluser|Amersham|2e5d5844ee642438ae963422c5e21e73','2016-02-24 10:33:22','2016-02-25 10:33:22'),(127,6,73,'apercival|Amersham|9ed927e0deefaa4e4782a3390f3c2124','2016-02-24 12:55:19','2016-02-25 12:55:19'),(129,9,83,'mdluser1|MDL|24d7d9b2bfa24c1107562dec27a19d50','2016-02-25 07:18:40','2016-02-26 07:18:40'),(130,9,83,'mdluser1|MDL|19843e60bf6acfbea909855c5f6e2951','2016-02-26 08:11:22','2016-02-27 08:11:22'),(131,9,84,'mdluser2|MDL|88afb06810f1300b20566920c201f81c','2016-02-26 16:48:18','2016-02-27 16:48:18'),(132,9,85,'mdluser3|MDL|a120f5f66c7fc0012054a33c4af0da83','2016-02-27 11:16:23','2016-02-28 11:16:23'),(133,9,83,'mdluser1|MDL|d6832d881cef4e1b22c3ff5c94cbb1d3','2016-02-27 14:15:49','2016-02-28 14:15:49'),(134,9,84,'mdluser2|MDL|ded8a33058d723b39318686e2096b4b0','2016-02-28 03:50:36','2016-02-29 03:50:36'),(135,9,83,'MDLuser1|MDL|7f98f06757c407df4d6d5e551c92563d','2016-02-28 15:08:45','2016-02-29 15:08:45'),(136,6,76,'mbloxham|Amersham|0c018b547c4baae0c4e000ff0abdcf74','2016-02-28 15:35:36','2016-02-29 15:35:36'),(137,9,84,'mdluser2|MDL|4e4fbb4d8d1810690b97a4cb2daf44de','2016-02-29 05:01:48','2016-03-01 05:01:48'),(138,9,85,'mdluser3|MDL|cf0bb0ff8487288df74839dccf5f1ca3','2016-02-29 08:06:29','2016-03-01 08:06:29'),(139,9,83,'mdluser1|mdl|f172d47a127f39aa76f012b551efc6f4','2016-02-29 15:11:15','2016-03-01 15:11:15'),(140,2,2,'Admin|Derry|8636b2e5efcb20867132502d46cd97e5','2016-02-29 16:55:49','2016-03-01 16:55:49'),(141,9,84,'mdluser2|MDL|ce7e1caf08b850c048418313a9df9dc7','2016-03-01 08:53:02','2016-03-02 08:53:02'),(142,9,83,'mdluser1|mdl|4e372902ef2dd293dc37ee74cc98ee3f','2016-03-01 15:33:29','2016-03-02 15:33:29'),(143,9,85,'mdluser3|MDL|62bc7469323126fafea5bbdfd7cf281f','2016-03-01 17:01:46','2016-03-02 17:01:46'),(144,9,84,'Mdluser2|MDL|f46b2178af1874d22ba35730d88595cc','2016-03-02 09:30:32','2016-03-03 09:30:32'),(145,2,2,'admin|Derry|c5c770e8c62c058489513ff289ebb3f5','2016-03-03 14:06:10','2016-03-04 14:06:10'),(146,2,2,'admin|derry|73df75042cc32e20228dcfccd129f688','2016-03-04 14:07:33','2016-03-05 14:07:33'),(147,2,2,'admin|DERRY|19f0917c09d810ec749b85cfde8976c7','2016-03-07 11:51:55','2016-03-08 11:51:55'),(148,9,83,'mdluser1|MDL|9762724d3c04361dd15e317f9d31fcdf','2016-03-09 10:25:32','2016-03-10 10:25:32'),(149,2,2,'admin|derry|d5505b95a2824c2d193acd3e11aa5c41','2016-03-09 10:30:06','2016-03-10 10:30:06'),(150,6,73,'apercival|Amersham|7106b3ccc79b1274905e3d4178694ce4','2016-03-11 18:04:26','2016-03-12 18:04:26'),(151,2,2,'admin|Derry|fae68d353b7659a01752892f84fd06d7','2016-03-15 15:48:48','2016-03-16 15:48:48'),(152,2,2,'admin|Derry|6bb648ea0e99763de5140dca03fee259','2016-03-18 10:07:13','2016-03-19 10:07:13'),(153,9,84,'mdluser2|MDL|514aa5bc5509b3b7adbe247f9ff40de4','2016-03-18 19:15:50','2016-03-19 19:15:50'),(154,10,86,'adm|mit|c89acbb77619708cf91ffd77bc6214b0','2016-03-18 19:37:33','2016-03-19 19:37:33'),(155,9,83,'mdluser1|MDL|64d28011503fa10078709a1d016e4ac4','2016-03-18 19:48:40','2016-03-19 19:48:40'),(156,10,90,'mcd|mit|2e4c8be5343e45e18dd4ea93e8706fce','2016-03-18 19:50:25','2016-03-19 19:50:25'),(165,12,102,'administrator|Mitra|224af07bbad1d3714d3c2e251fa4bf71','2016-03-22 11:54:19','2016-03-23 11:54:19'),(166,12,103,'bruce|Mitra|419d6c193830d19217e214ff24bf6381','2016-03-22 12:04:51','2016-03-23 12:04:51'),(167,12,105,'gow|mitra|38621b95aa21487ab6d7293982f71ec5','2016-03-22 12:09:18','2016-03-23 12:09:18'),(168,12,104,'Forbes|Mitra|02cd669c87b14ad19d5139764bddd500','2016-03-22 15:52:52','2016-03-23 15:52:52'),(169,12,107,'Twine|Mitra|a9e1953edabc63e297cdab8c46ce755f','2016-03-23 07:08:27','2016-03-24 07:08:27'),(170,12,106,'McDonald|Mitra|cfa587bf06ef7ddf0ea3e61a482771b4','2016-03-23 10:12:56','2016-03-24 10:12:56'),(171,12,110,'Pace|Mitra|3c929d88bbd0f4499c7b04a58037ae94','2016-03-23 11:03:18','2016-03-24 11:03:18'),(172,12,102,'administrator|mitra|0c27335b92f282ebc7cb7a0d25d42da8','2016-03-23 12:03:26','2016-03-24 12:03:26'),(173,12,103,'Bruce|mitra|0fddab719b3dfd60ac7ab660debe2827','2016-03-23 12:08:51','2016-03-24 12:08:51'),(174,12,104,'Forbes|mitra|dce97d7852ce0cdf9f5d224d5ff282d6','2016-03-24 04:40:03','2016-03-25 04:40:03'),(175,12,105,'Gow|Mitra|723ffbf860eedcfd90980595d1caa849','2016-03-24 05:51:04','2016-03-25 05:51:04'),(176,12,107,'Twine|Mitra|57d41ee44e156e1d8baf78626b8d6f65','2016-03-24 07:21:18','2016-03-25 07:21:18'),(177,12,106,'McDonald|Mitra|6dfab0d9a6d2626675e298b7472d15dd','2016-03-24 11:10:47','2016-03-25 11:10:47'),(178,12,102,'administrator|mitra|07fe93706325fff837cf298643785c1f','2016-03-24 12:10:02','2016-03-25 12:10:02'),(179,12,103,'bruce|Mitra|54b1949c53da2d320cc4c4725b3836d1','2016-03-24 13:51:11','2016-03-25 13:51:11'),(180,12,105,'GOW|mitra|52a47607af9c44a2ff21dc709255271f','2016-03-25 06:02:51','2016-03-26 06:02:51'),(181,12,106,'McDonald|Mitra|5f0781912df4d936fe6c2dce61acc1e7','2016-03-25 11:19:56','2016-03-26 11:19:56'),(182,12,102,'administrator|Mitra|239071e88bd12b70c1795a72afaac591','2016-03-25 12:23:52','2016-03-26 12:23:52'),(183,12,107,'Twine|Mitra|078e575c0d7c16011b2af41bd8c6a06b','2016-03-25 13:32:29','2016-03-26 13:32:29'),(184,12,102,'administrator|Mitra|7a8c38eaf3cc2b2f0e7579e9db7c71e5','2016-03-27 06:17:10','2016-03-28 06:17:10'),(185,12,103,'bruce|mitra|e34d9f5ddbb8c36e147f103e8f1afc8a','2016-03-28 04:10:16','2016-03-29 04:10:16'),(186,12,105,'GOW|mitra|2a378c16006b9f2482094e60f5370919','2016-03-28 05:25:39','2016-03-29 05:25:39'),(187,12,102,'administrator|mitra|6218992345d236179ee1815274603713','2016-03-28 08:09:19','2016-03-29 08:09:19'),(188,12,107,'Twine|Mitra|551fa1ea47377aea0b99d863319f58ad','2016-03-28 11:26:55','2016-03-29 11:26:55'),(189,12,103,'bruce|mitra|28244b9c4092387dee8f4dde91e3c5fb','2016-03-29 04:21:17','2016-03-30 04:21:17'),(190,12,105,'Gow|Mitra|647b2ebc1323b10c7f49b84a3d0278c2','2016-03-29 06:55:14','2016-03-30 06:55:14'),(191,12,102,'administrator|mitra|55d3ea1ef8ed3f5a4f2ba9d31f639602','2016-03-29 08:21:04','2016-03-30 08:21:04'),(192,12,107,'Twine|Mitra|4a7832b672c92022a9e7f24d9b8b4376','2016-03-30 04:03:44','2016-03-31 04:03:44'),(193,12,103,'bruce|mitra|c1cdf9493df2cc5811b9b6d1ac761511','2016-03-30 04:46:45','2016-03-31 04:46:45'),(194,12,102,'administrator|mitra|9890123fff479b0544dd43bc588dcca3','2016-03-30 08:43:31','2016-03-31 08:43:31'),(195,12,106,'McDonald|Mitra|eae2192f45dc7e23dc3d7fd48f450b44','2016-03-30 10:36:53','2016-03-31 10:36:53'),(196,12,105,'Gow|Mitra|18bf5797444134a9d95a51e256fbd8c2','2016-03-31 10:19:24','2016-04-01 10:19:24'),(197,12,102,'Administrator|Mitra|f7f4481c95a872c468e910c5f00e8b5b','2016-03-31 10:19:53','2016-04-01 10:19:53'),(198,12,103,'bruce|mitra|10b5bf9c6fa1c88fb10366d1200cf7c1','2016-03-31 10:37:27','2016-04-01 10:37:27'),(199,12,107,'Twine|Mitra|507f3258951b9ba64f883305b6ff881f','2016-03-31 10:52:23','2016-04-01 10:52:23'),(200,12,106,'McDonald|Mitra|c06140ad270dfa085bbe8e4d544fe753','2016-03-31 11:01:01','2016-04-01 11:01:01'),(201,13,121,'admin|sliit|81d3a8ce960f416ef7d39723ad254cbc','2016-03-31 17:29:01','2016-04-01 17:29:01'),(202,14,123,'admin|sliit2|48ff4b56d0e44285e984660e88696834','2016-03-31 21:47:24','2016-04-01 21:47:24'),(203,15,125,'admin|org_2|1ebbd8a506ca97139aa6bead44c41f9d','2016-04-01 05:21:54','2016-04-02 05:21:54'),(204,16,126,'Administrator3|Mitra3|b8c9fee8fa9ecb81a2ffc892b6b7871e','2016-04-01 06:34:48','2016-04-02 06:34:48'),(205,16,128,'star|mitra3|2f99770ad49a52a786edd1c69d6969a3','2016-04-01 06:47:51','2016-04-02 06:47:51'),(206,17,127,'Administrator4|Mitra4|897a599f84be12075be9943dbb807950','2016-04-01 07:30:17','2016-04-02 07:30:17'),(207,12,105,'Gow|Mitra|02a996aa7aababda3814e3a38c929d94','2016-04-01 10:28:53','2016-04-02 10:28:53'),(208,12,102,'administrator|mitra|15dba935629df0ce7c19b7d6b596de86','2016-04-01 11:13:07','2016-04-02 11:13:07');
/*!40000 ALTER TABLE `access_token` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `role`
--

DROP TABLE IF EXISTS `role`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `role` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `organization_id` int(11) NOT NULL,
  `name` varchar(45) NOT NULL,
  `description` varchar(255) DEFAULT NULL,
  `createdon` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedon` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `organization_fk_idx` (`organization_id`),
  CONSTRAINT `organization_fk` FOREIGN KEY (`organization_id`) REFERENCES `subscription`.`organization` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=79 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `role`
--

LOCK TABLES `role` WRITE;
/*!40000 ALTER TABLE `role` DISABLE KEYS */;
INSERT INTO `role` VALUES (1,2,'super admin','super admin role','2016-01-13 04:18:18',NULL),(2,3,'admin','Election Manager','2016-01-21 14:02:10',NULL),(3,4,'manager','manager role','2016-01-21 14:02:11',NULL),(4,2,'Manager','Manager Role for overall management','2016-01-13 04:18:18','2016-01-29 07:44:56'),(5,2,'Counter','Counter Role','2016-01-28 03:57:07',NULL),(6,2,'Staff Officer','staff oficcer role','2016-01-28 04:00:55',NULL),(7,2,'Ballot Manager','ballot manager role','2016-01-28 04:02:44',NULL),(8,2,'Facility Manager','Facilitry manager role for the building','2016-01-28 04:04:07','2016-01-29 07:45:23'),(9,2,'Security Manager','sec manager','2016-01-28 04:06:10',NULL),(10,2,'Vehicle Manager','manages the vehicles','2016-01-28 04:09:07',NULL),(11,2,'Pacifier','pacifier role','2016-01-28 04:11:09',NULL),(12,2,'Presiding Officer','presiding officer role','2016-01-28 07:43:22',NULL),(13,2,'Election Officer','election officer','2016-01-28 08:03:39',NULL),(14,5,'Presiding Officer','Presiding Officer','2016-02-02 15:36:22',NULL),(15,2,'Brain','PSMM','2016-02-03 10:32:02','2016-02-03 10:32:22'),(16,6,'Presiding Officer','Presiding Officer','2016-02-05 10:02:37',NULL),(17,6,'Issue Resolver','Issue Resolver','2016-02-05 10:03:01',NULL),(18,6,'Election Manager','Election Manager','2016-02-05 10:03:22',NULL),(19,7,'Presiding Officer','Presiding Officer','2016-02-05 10:02:37',NULL),(20,7,'Issue Resolver','Issue Resolver','2016-02-05 10:03:01',NULL),(21,7,'Election Manager','Election Manager','2016-02-05 10:03:22',NULL),(22,8,'Presiding Officer','Presiding Officer','2016-02-05 10:02:37',NULL),(23,8,'Issue Resolver','Issue Resolver','2016-02-05 10:03:01',NULL),(24,8,'Election Manager','Election Manager','2016-02-05 10:03:22',NULL),(25,9,'EM','Election Manager','2016-02-05 10:03:22',NULL),(26,9,'PSM','Presiding Officer','2016-02-05 10:03:22',NULL),(27,10,'Election Manager','Election Manager','2016-03-18 19:37:17',NULL),(28,10,'Presiding Officer','Presiding Officer','2016-03-18 19:37:17',NULL),(29,10,'Super Presiding Officer','Super Presiding Officer','2016-03-18 19:37:17',NULL),(30,10,'Issue Resolver','Issue Resolver','2016-03-18 19:37:17',NULL),(31,10,'Polling Station Inspector','Polling Station Inspector','2016-03-18 19:37:17',NULL),(38,12,'Presiding Officer','Presiding Officer','2016-03-22 11:53:17',NULL),(39,12,'Super Presiding Officer','Super Presiding Officer','2016-03-22 11:53:17',NULL),(40,12,'Issue Resolver','Issue Resolver','2016-03-22 11:53:17',NULL),(41,12,'Polling Station Inspector','Polling Station Inspector','2016-03-22 11:53:17',NULL),(42,12,'shai','super','2016-03-24 10:57:28',NULL),(46,12,'1234','numbers add for role name','2016-03-29 11:28:04',NULL),(50,12,'change user 1','cccc','2016-03-29 11:53:31','2016-03-29 16:41:20'),(53,12,'Poll Station Inspector','POi18','2016-03-30 11:12:15','2016-03-30 12:29:33'),(54,13,'Election Manager','Election Manager','2016-03-31 17:25:30',NULL),(55,13,'Presiding Officer','Presiding Officer','2016-03-31 17:25:30',NULL),(56,13,'Super Presiding Officer','Super Presiding Officer','2016-03-31 17:25:30',NULL),(57,13,'Issue Resolver','Issue Resolver','2016-03-31 17:25:30',NULL),(58,13,'Polling Station Inspector','Polling Station Inspector','2016-03-31 17:25:30',NULL),(59,14,'Election Manager','Election Manager','2016-03-31 21:46:35',NULL),(60,14,'Presiding Officer','Presiding Officer','2016-03-31 21:46:35',NULL),(61,14,'Super Presiding Officer','Super Presiding Officer','2016-03-31 21:46:35',NULL),(62,14,'Issue Resolver','Issue Resolver','2016-03-31 21:46:35',NULL),(63,14,'Polling Station Inspector','Polling Station Inspector','2016-03-31 21:46:35',NULL),(64,15,'Election Manager','Election Manager','2016-04-01 05:21:08',NULL),(65,15,'Presiding Officer','Presiding Officer','2016-04-01 05:21:08',NULL),(66,15,'Super Presiding Officer','Super Presiding Officer','2016-04-01 05:21:08',NULL),(67,15,'Issue Resolver','Issue Resolver','2016-04-01 05:21:08',NULL),(68,15,'Polling Station Inspector','Polling Station Inspector','2016-04-01 05:21:08',NULL),(69,16,'Election Manager','Election Manager','2016-04-01 06:34:14',NULL),(70,16,'Presiding Officer','Presiding Officer','2016-04-01 06:34:14',NULL),(71,16,'Super Presiding Officer','Super Presiding Officer','2016-04-01 06:34:14',NULL),(72,16,'Issue Resolver','Issue Resolver','2016-04-01 06:34:14',NULL),(73,16,'Polling Station Inspector','Polling Station Inspector','2016-04-01 06:34:14',NULL),(74,17,'Election Manager','Election Manager','2016-04-01 06:40:34',NULL),(75,17,'Presiding Officer','Presiding Officer','2016-04-01 06:40:34',NULL),(76,17,'Super Presiding Officer','Super Presiding Officer','2016-04-01 06:40:34',NULL),(77,17,'Issue Resolver','Issue Resolver','2016-04-01 06:40:34',NULL),(78,17,'Polling Station Inspector','Polling Station Inspector','2016-04-01 06:40:34',NULL);
/*!40000 ALTER TABLE `role` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `role_permission`
--

DROP TABLE IF EXISTS `role_permission`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `role_permission` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `organization_id` int(11) NOT NULL,
  `role_id` int(11) NOT NULL,
  `permission_id` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `role_per_fk1_idx` (`role_id`),
  KEY `role_per_fk2_idx` (`permission_id`),
  KEY `role_per_fk3_idx` (`organization_id`),
  CONSTRAINT `role_per_fk1` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `role_per_fk2` FOREIGN KEY (`permission_id`) REFERENCES `subscription`.`permission` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `role_per_fk3` FOREIGN KEY (`organization_id`) REFERENCES `subscription`.`organization` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=1824 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `role_permission`
--

LOCK TABLES `role_permission` WRITE;
/*!40000 ALTER TABLE `role_permission` DISABLE KEYS */;
INSERT INTO `role_permission` VALUES (1,2,1,1),(2,2,1,2),(3,2,1,3),(4,2,1,4),(5,2,1,5),(6,2,1,6),(7,2,1,7),(8,2,1,8),(9,2,1,9),(10,2,1,10),(11,2,1,11),(12,2,1,12),(13,2,1,13),(14,2,1,14),(15,2,1,15),(16,2,1,16),(17,2,1,17),(18,2,1,18),(19,2,1,19),(20,2,1,20),(21,2,1,21),(22,2,1,22),(23,3,2,1),(24,3,2,2),(25,3,2,3),(26,3,2,4),(27,3,2,5),(28,3,2,6),(29,3,2,7),(30,3,2,8),(31,3,2,9),(32,3,2,10),(33,3,2,11),(34,3,2,12),(35,3,2,13),(36,3,2,14),(37,3,2,15),(38,3,2,16),(39,3,2,17),(40,3,2,18),(41,3,2,19),(42,3,2,20),(43,3,2,21),(44,3,2,22),(54,4,3,1),(55,4,3,2),(56,4,3,3),(57,4,3,4),(58,4,3,5),(59,4,3,6),(60,4,3,7),(61,4,3,8),(62,4,3,9),(63,4,3,10),(64,4,3,11),(65,4,3,12),(66,4,3,13),(67,4,3,14),(68,4,3,15),(69,4,3,16),(70,4,3,17),(71,4,3,18),(72,4,3,19),(73,4,3,20),(74,4,3,21),(75,4,3,22),(76,2,1,23),(77,2,1,24),(78,2,1,25),(79,2,1,26),(80,2,1,27),(81,3,2,25),(82,3,2,26),(83,3,2,27),(84,3,2,4),(85,3,1,24),(86,3,2,24),(87,5,14,1),(88,5,14,2),(89,5,14,3),(90,5,14,4),(91,5,14,5),(92,5,14,6),(93,5,14,7),(94,5,14,8),(95,5,14,9),(96,5,14,10),(97,5,14,11),(98,5,14,12),(99,5,14,13),(100,5,14,14),(101,5,14,15),(102,5,14,16),(103,5,14,17),(104,5,14,18),(105,5,14,19),(106,5,14,20),(107,5,14,21),(108,5,14,22),(109,5,14,23),(110,5,14,24),(111,5,14,25),(112,5,14,26),(113,5,14,27),(118,2,1,28),(119,2,1,29),(120,2,1,30),(121,2,1,31),(215,2,1,32),(216,7,19,1),(217,7,19,2),(218,7,19,3),(219,7,19,4),(220,7,19,5),(221,7,19,6),(222,7,19,7),(223,7,19,8),(224,7,19,9),(225,7,19,10),(226,7,19,11),(227,7,19,12),(228,7,19,13),(229,7,19,14),(230,7,19,15),(231,7,19,16),(232,7,19,17),(233,7,19,18),(234,7,19,19),(235,7,19,20),(236,7,19,21),(237,7,19,22),(238,7,19,23),(239,7,19,24),(240,7,19,25),(241,7,19,26),(242,7,19,27),(243,7,19,28),(244,7,19,29),(245,7,19,30),(246,7,19,31),(247,7,19,32),(279,7,20,1),(280,7,20,2),(281,7,20,3),(282,7,20,4),(283,7,20,5),(284,7,20,6),(285,7,20,7),(286,7,20,8),(287,7,20,9),(288,7,20,10),(289,7,20,11),(290,7,20,12),(291,7,20,13),(292,7,20,14),(293,7,20,15),(294,7,20,16),(295,7,20,17),(296,7,20,18),(297,7,20,19),(298,7,20,20),(299,7,20,21),(300,7,20,22),(301,7,20,23),(302,7,20,24),(303,7,20,25),(304,7,20,26),(305,7,20,27),(306,7,20,28),(307,7,20,29),(308,7,20,30),(309,7,20,31),(310,7,20,32),(342,7,21,1),(343,7,21,2),(344,7,21,3),(345,7,21,4),(346,7,21,5),(347,7,21,6),(348,7,21,7),(349,7,21,8),(350,7,21,9),(351,7,21,10),(352,7,21,11),(353,7,21,12),(354,7,21,13),(355,7,21,14),(356,7,21,15),(357,7,21,16),(358,7,21,17),(359,7,21,18),(360,7,21,19),(361,7,21,20),(362,7,21,21),(363,7,21,22),(364,7,21,23),(365,7,21,24),(366,7,21,25),(367,7,21,26),(368,7,21,27),(369,7,21,28),(370,7,21,29),(371,7,21,30),(372,7,21,31),(373,7,21,32),(405,8,22,1),(406,8,22,2),(407,8,22,3),(408,8,22,4),(409,8,22,5),(410,8,22,6),(411,8,22,7),(412,8,22,8),(413,8,22,9),(414,8,22,10),(415,8,22,11),(416,8,22,12),(417,8,22,13),(418,8,22,14),(419,8,22,15),(420,8,22,16),(421,8,22,17),(422,8,22,18),(423,8,22,19),(424,8,22,20),(425,8,22,21),(426,8,22,22),(427,8,22,23),(428,8,22,24),(429,8,22,25),(430,8,22,26),(431,8,22,27),(432,8,22,28),(433,8,22,29),(434,8,22,30),(435,8,22,31),(436,8,22,32),(468,8,23,1),(469,8,23,2),(470,8,23,3),(471,8,23,4),(472,8,23,5),(473,8,23,6),(474,8,23,7),(475,8,23,8),(476,8,23,9),(477,8,23,10),(478,8,23,11),(479,8,23,12),(480,8,23,13),(481,8,23,14),(482,8,23,15),(483,8,23,16),(484,8,23,17),(485,8,23,18),(486,8,23,19),(487,8,23,20),(488,8,23,21),(489,8,23,22),(490,8,23,23),(491,8,23,24),(492,8,23,25),(493,8,23,26),(494,8,23,27),(495,8,23,28),(496,8,23,29),(497,8,23,30),(498,8,23,31),(499,8,23,32),(531,8,24,1),(532,8,24,2),(533,8,24,3),(534,8,24,4),(535,8,24,5),(536,8,24,6),(537,8,24,7),(538,8,24,8),(539,8,24,9),(540,8,24,10),(541,8,24,11),(542,8,24,12),(543,8,24,13),(544,8,24,14),(545,8,24,15),(546,8,24,16),(547,8,24,17),(548,8,24,18),(549,8,24,19),(550,8,24,20),(551,8,24,21),(552,8,24,22),(553,8,24,23),(554,8,24,24),(555,8,24,25),(556,8,24,26),(557,8,24,27),(558,8,24,28),(559,8,24,29),(560,8,24,30),(561,8,24,31),(562,8,24,32),(594,6,16,1),(595,6,16,2),(596,6,16,3),(597,6,16,4),(598,6,16,5),(599,6,16,6),(600,6,16,7),(601,6,16,8),(602,6,16,9),(603,6,16,10),(604,6,16,11),(605,6,16,12),(606,6,16,13),(607,6,16,14),(608,6,16,15),(609,6,16,16),(610,6,16,17),(611,6,16,18),(612,6,16,19),(613,6,16,20),(614,6,16,21),(615,6,16,22),(616,6,16,23),(617,6,16,24),(618,6,16,25),(619,6,16,26),(620,6,16,27),(621,6,16,28),(622,6,16,29),(623,6,16,30),(624,6,16,31),(625,6,16,32),(657,6,17,1),(658,6,17,2),(659,6,17,3),(660,6,17,4),(661,6,17,5),(662,6,17,6),(663,6,17,7),(664,6,17,8),(665,6,17,9),(666,6,17,10),(667,6,17,11),(668,6,17,12),(669,6,17,13),(670,6,17,14),(671,6,17,15),(672,6,17,16),(673,6,17,17),(674,6,17,18),(675,6,17,19),(676,6,17,20),(677,6,17,21),(678,6,17,22),(679,6,17,23),(680,6,17,24),(681,6,17,25),(682,6,17,26),(683,6,17,27),(684,6,17,28),(685,6,17,29),(686,6,17,30),(687,6,17,31),(688,6,17,32),(720,6,18,1),(721,6,18,2),(722,6,18,3),(723,6,18,4),(724,6,18,5),(725,6,18,6),(726,6,18,7),(727,6,18,8),(728,6,18,9),(729,6,18,10),(730,6,18,11),(731,6,18,12),(732,6,18,13),(733,6,18,14),(734,6,18,15),(735,6,18,16),(736,6,18,17),(737,6,18,18),(738,6,18,19),(739,6,18,20),(740,6,18,21),(741,6,18,22),(742,6,18,23),(743,6,18,24),(744,6,18,25),(745,6,18,26),(746,6,18,27),(747,6,18,28),(748,6,18,29),(749,6,18,30),(750,6,18,31),(751,6,18,32),(783,9,25,1),(784,9,25,2),(785,9,25,3),(786,9,25,4),(787,9,25,5),(788,9,25,6),(789,9,25,7),(790,9,25,8),(791,9,25,9),(792,9,25,10),(793,9,25,11),(794,9,25,12),(795,9,25,13),(796,9,25,14),(797,9,25,15),(798,9,25,16),(799,9,25,17),(800,9,25,18),(801,9,25,19),(802,9,25,20),(803,9,25,21),(804,9,25,22),(805,9,25,23),(806,9,25,24),(807,9,25,25),(808,9,25,26),(809,9,25,27),(810,9,25,28),(811,9,25,29),(812,9,25,30),(813,9,25,31),(814,9,25,32),(815,9,26,1),(816,9,26,2),(817,9,26,3),(818,9,26,4),(819,9,26,5),(820,9,26,6),(821,9,26,7),(822,9,26,8),(823,9,26,9),(824,9,26,10),(825,9,26,11),(826,9,26,12),(827,9,26,13),(828,9,26,14),(829,9,26,15),(830,9,26,16),(831,9,26,17),(832,9,26,18),(833,9,26,19),(834,9,26,20),(835,9,26,21),(836,9,26,22),(837,9,26,23),(838,9,26,24),(839,9,26,25),(840,9,26,26),(841,9,26,27),(842,9,26,28),(843,9,26,29),(844,9,26,30),(845,9,26,31),(846,9,26,32),(847,10,28,1),(848,10,28,2),(849,10,28,3),(850,10,28,4),(851,10,28,5),(852,10,28,6),(853,10,28,7),(854,10,28,8),(855,10,28,9),(856,10,28,10),(857,10,28,11),(858,10,28,12),(859,10,28,13),(860,10,28,14),(861,10,28,15),(862,10,28,16),(863,10,28,17),(864,10,28,18),(865,10,28,19),(866,10,28,20),(867,10,28,21),(868,10,28,22),(869,10,28,23),(870,10,28,24),(871,10,28,25),(872,10,28,26),(873,10,28,27),(874,10,28,28),(875,10,28,29),(876,10,28,30),(877,10,28,31),(878,10,28,32),(910,10,27,1),(911,10,27,2),(912,10,27,3),(913,10,27,4),(914,10,27,5),(915,10,27,6),(916,10,27,7),(917,10,27,8),(918,10,27,9),(919,10,27,10),(920,10,27,11),(921,10,27,12),(922,10,27,13),(923,10,27,14),(924,10,27,15),(925,10,27,16),(926,10,27,17),(927,10,27,18),(928,10,27,19),(929,10,27,20),(930,10,27,21),(931,10,27,22),(932,10,27,28),(933,10,27,29),(934,10,27,30),(935,10,27,31),(936,10,27,32),(937,10,27,23),(938,10,27,24),(939,10,27,25),(940,10,27,26),(941,10,27,27),(1099,12,38,1),(1100,12,38,2),(1101,12,38,3),(1102,12,38,4),(1103,12,38,5),(1104,12,38,6),(1105,12,38,7),(1106,12,38,8),(1107,12,38,9),(1108,12,38,10),(1109,12,38,11),(1110,12,38,12),(1111,12,38,13),(1112,12,38,14),(1113,12,38,15),(1114,12,38,16),(1115,12,38,17),(1116,12,38,18),(1117,12,38,19),(1118,12,38,20),(1119,12,38,21),(1120,12,38,22),(1121,12,38,23),(1122,12,38,24),(1123,12,38,25),(1124,12,38,26),(1125,12,38,27),(1126,12,38,28),(1127,12,38,29),(1128,12,38,30),(1129,12,38,31),(1130,12,38,32),(1162,12,40,1),(1163,12,40,2),(1164,12,40,3),(1165,12,40,4),(1166,12,40,5),(1167,12,40,6),(1168,12,40,7),(1169,12,40,8),(1170,12,40,9),(1171,12,40,10),(1172,12,40,11),(1173,12,40,12),(1174,12,40,13),(1175,12,40,14),(1176,12,40,15),(1177,12,40,16),(1178,12,40,17),(1179,12,40,18),(1180,12,40,19),(1181,12,40,20),(1182,12,40,21),(1183,12,40,22),(1184,12,40,28),(1185,12,40,29),(1186,12,40,30),(1187,12,40,31),(1188,12,40,32),(1189,12,40,23),(1190,12,40,24),(1191,12,40,25),(1192,12,40,26),(1193,12,40,27),(1194,13,55,1),(1195,13,55,2),(1196,13,55,3),(1197,13,55,4),(1198,13,55,5),(1199,13,55,6),(1200,13,55,7),(1201,13,55,8),(1202,13,55,9),(1203,13,55,10),(1204,13,55,11),(1205,13,55,12),(1206,13,55,13),(1207,13,55,14),(1208,13,55,15),(1209,13,55,16),(1210,13,55,17),(1211,13,55,18),(1212,13,55,19),(1213,13,55,20),(1214,13,55,21),(1215,13,55,22),(1216,13,55,23),(1217,13,55,24),(1218,13,55,25),(1219,13,55,26),(1220,13,55,27),(1221,13,55,28),(1222,13,55,29),(1223,13,55,30),(1224,13,55,31),(1225,13,55,32),(1257,13,54,1),(1258,13,54,2),(1259,13,54,3),(1260,13,54,4),(1261,13,54,5),(1262,13,54,6),(1263,13,54,7),(1264,13,54,8),(1265,13,54,9),(1266,13,54,10),(1267,13,54,11),(1268,13,54,12),(1269,13,54,13),(1270,13,54,14),(1271,13,54,15),(1272,13,54,16),(1273,13,54,17),(1274,13,54,18),(1275,13,54,19),(1276,13,54,20),(1277,13,54,21),(1278,13,54,22),(1279,13,54,28),(1280,13,54,29),(1281,13,54,30),(1282,13,54,31),(1283,13,54,32),(1284,13,54,23),(1285,13,54,24),(1286,13,54,25),(1287,13,54,26),(1288,13,54,27),(1320,14,60,1),(1321,14,60,2),(1322,14,60,3),(1323,14,60,4),(1324,14,60,5),(1325,14,60,6),(1326,14,60,7),(1327,14,60,8),(1328,14,60,9),(1329,14,60,10),(1330,14,60,11),(1331,14,60,12),(1332,14,60,13),(1333,14,60,14),(1334,14,60,15),(1335,14,60,16),(1336,14,60,17),(1337,14,60,18),(1338,14,60,19),(1339,14,60,20),(1340,14,60,21),(1341,14,60,22),(1342,14,60,23),(1343,14,60,24),(1344,14,60,25),(1345,14,60,26),(1346,14,60,27),(1347,14,60,28),(1348,14,60,29),(1349,14,60,30),(1350,14,60,31),(1351,14,60,32),(1383,14,59,1),(1384,14,59,2),(1385,14,59,3),(1386,14,59,4),(1387,14,59,5),(1388,14,59,6),(1389,14,59,7),(1390,14,59,8),(1391,14,59,9),(1392,14,59,10),(1393,14,59,11),(1394,14,59,12),(1395,14,59,13),(1396,14,59,14),(1397,14,59,15),(1398,14,59,16),(1399,14,59,17),(1400,14,59,18),(1401,14,59,19),(1402,14,59,20),(1403,14,59,21),(1404,14,59,22),(1405,14,59,28),(1406,14,59,29),(1407,14,59,30),(1408,14,59,31),(1409,14,59,32),(1410,14,59,23),(1411,14,59,24),(1412,14,59,25),(1413,14,59,26),(1414,14,59,27),(1446,15,65,1),(1447,15,65,2),(1448,15,65,3),(1449,15,65,4),(1450,15,65,5),(1451,15,65,6),(1452,15,65,7),(1453,15,65,8),(1454,15,65,9),(1455,15,65,10),(1456,15,65,11),(1457,15,65,12),(1458,15,65,13),(1459,15,65,14),(1460,15,65,15),(1461,15,65,16),(1462,15,65,17),(1463,15,65,18),(1464,15,65,19),(1465,15,65,20),(1466,15,65,21),(1467,15,65,22),(1468,15,65,23),(1469,15,65,24),(1470,15,65,25),(1471,15,65,26),(1472,15,65,27),(1473,15,65,28),(1474,15,65,29),(1475,15,65,30),(1476,15,65,31),(1477,15,65,32),(1509,15,64,1),(1510,15,64,2),(1511,15,64,3),(1512,15,64,4),(1513,15,64,5),(1514,15,64,6),(1515,15,64,7),(1516,15,64,8),(1517,15,64,9),(1518,15,64,10),(1519,15,64,11),(1520,15,64,12),(1521,15,64,13),(1522,15,64,14),(1523,15,64,15),(1524,15,64,16),(1525,15,64,17),(1526,15,64,18),(1527,15,64,19),(1528,15,64,20),(1529,15,64,21),(1530,15,64,22),(1531,15,64,28),(1532,15,64,29),(1533,15,64,30),(1534,15,64,31),(1535,15,64,32),(1536,15,64,23),(1537,15,64,24),(1538,15,64,25),(1539,15,64,26),(1540,15,64,27),(1572,16,70,1),(1573,16,70,2),(1574,16,70,3),(1575,16,70,4),(1576,16,70,5),(1577,16,70,6),(1578,16,70,7),(1579,16,70,8),(1580,16,70,9),(1581,16,70,10),(1582,16,70,11),(1583,16,70,12),(1584,16,70,13),(1585,16,70,14),(1586,16,70,15),(1587,16,70,16),(1588,16,70,17),(1589,16,70,18),(1590,16,70,19),(1591,16,70,20),(1592,16,70,21),(1593,16,70,22),(1594,16,70,23),(1595,16,70,24),(1596,16,70,25),(1597,16,70,26),(1598,16,70,27),(1599,16,70,28),(1600,16,70,29),(1601,16,70,30),(1602,16,70,31),(1603,16,70,32),(1635,16,69,1),(1636,16,69,2),(1637,16,69,3),(1638,16,69,4),(1639,16,69,5),(1640,16,69,6),(1641,16,69,7),(1642,16,69,8),(1643,16,69,9),(1644,16,69,10),(1645,16,69,11),(1646,16,69,12),(1647,16,69,13),(1648,16,69,14),(1649,16,69,15),(1650,16,69,16),(1651,16,69,17),(1652,16,69,18),(1653,16,69,19),(1654,16,69,20),(1655,16,69,21),(1656,16,69,22),(1657,16,69,28),(1658,16,69,29),(1659,16,69,30),(1660,16,69,31),(1661,16,69,32),(1662,16,69,23),(1663,16,69,24),(1664,16,69,25),(1665,16,69,26),(1666,16,69,27),(1698,17,75,1),(1699,17,75,2),(1700,17,75,3),(1701,17,75,4),(1702,17,75,5),(1703,17,75,6),(1704,17,75,7),(1705,17,75,8),(1706,17,75,9),(1707,17,75,10),(1708,17,75,11),(1709,17,75,12),(1710,17,75,13),(1711,17,75,14),(1712,17,75,15),(1713,17,75,16),(1714,17,75,17),(1715,17,75,18),(1716,17,75,19),(1717,17,75,20),(1718,17,75,21),(1719,17,75,22),(1720,17,75,23),(1721,17,75,24),(1722,17,75,25),(1723,17,75,26),(1724,17,75,27),(1725,17,75,28),(1726,17,75,29),(1727,17,75,30),(1728,17,75,31),(1729,17,75,32),(1761,17,74,1),(1762,17,74,2),(1763,17,74,3),(1764,17,74,4),(1765,17,74,5),(1766,17,74,6),(1767,17,74,7),(1768,17,74,8),(1769,17,74,9),(1770,17,74,10),(1771,17,74,11),(1772,17,74,12),(1773,17,74,13),(1774,17,74,14),(1775,17,74,15),(1776,17,74,16),(1777,17,74,17),(1778,17,74,18),(1779,17,74,19),(1780,17,74,20),(1781,17,74,21),(1782,17,74,22),(1783,17,74,28),(1784,17,74,29),(1785,17,74,30),(1786,17,74,31),(1787,17,74,32),(1788,17,74,23),(1789,17,74,24),(1790,17,74,25),(1791,17,74,26),(1792,17,74,27);
/*!40000 ALTER TABLE `role_permission` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user`
--

DROP TABLE IF EXISTS `user`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `organization_id` int(11) NOT NULL,
  `firstname` varchar(45) NOT NULL,
  `lastname` varchar(45) NOT NULL,
  `email` varchar(45) DEFAULT NULL,
  `username` varchar(45) NOT NULL,
  `passwordhash` varchar(500) NOT NULL,
  `passwordsalt` varchar(500) NOT NULL DEFAULT 'S@l+VaL',
  `apikey` varchar(45) DEFAULT NULL,
  `birthday` date DEFAULT NULL,
  `gender` varchar(1) DEFAULT NULL,
  `timezone` varchar(45) DEFAULT NULL,
  `locale` varchar(45) DEFAULT NULL,
  `language_id` int(11) NOT NULL,
  `login_count` int(11) DEFAULT NULL,
  `last_login` timestamp NULL DEFAULT NULL,
  `createdon` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedon` timestamp NULL DEFAULT NULL,
  `profile_picture` varchar(255) DEFAULT '/data/media/profile.jpg',
  `is_deleted` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `organization_fk_idx` (`organization_id`),
  KEY `user_name_idx` (`username`),
  CONSTRAINT `organization_user_fk` FOREIGN KEY (`organization_id`) REFERENCES `subscription`.`organization` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=131 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user`
--

LOCK TABLES `user` WRITE;
/*!40000 ALTER TABLE `user` DISABLE KEYS */;
INSERT INTO `user` VALUES (2,2,'admin','user','rarunod@mitrai.com','admin','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL','','2012-01-01','M','','en-GB',1,NULL,NULL,'2016-01-13 04:18:34',NULL,NULL,0),(5,2,'John','Doe','aamarasinghe@mitrai.com','johndoe','3e8c7dd165aa540b459be7527115f588ad7f9e0c','123',NULL,'2012-01-01','M',NULL,'en-GB',1,NULL,NULL,'2016-01-21 11:07:32',NULL,NULL,0),(6,2,'Jane','Doe','aperera@mitrai.com','janedoe','ad565542ccacde4811e50c3088e9858fa6817449','456',NULL,'2012-01-01','F',NULL,'en-GB',1,NULL,NULL,'2016-01-21 11:07:33',NULL,NULL,0),(7,3,'Mark ','Hunter','Mark@Mark .com','Mark','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,'2012-01-01','M',NULL,'en-GB',1,NULL,NULL,'2016-01-21 13:59:08',NULL,NULL,0),(8,3,'Anne','Wilks','Anne@Anne.com','Anne','ad565542ccacde4811e50c3088e9858fa6817449','456',NULL,'2012-01-01','F',NULL,'en-GB',1,NULL,NULL,'2016-01-21 13:59:08',NULL,NULL,0),(9,3,'Carol','Forbes',NULL,'Carol','f7e8aad3acea29cab7ea32a8a37aa64fc83c2bdf','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:40',NULL,NULL,0),(10,5,'Stirling','Gow',NULL,'Stirling','27a6777633bc3d68a0627514af83317cfac35082','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:40',NULL,NULL,0),(11,5,'Sandra','Bruce',NULL,'Sandra','2aa5009dcddcd040ed54724960e92f6e181d821a','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:40',NULL,NULL,0),(12,5,'Karen','McDonald',NULL,'Karen','b23253eed4dfc5b9b0192b32e28aea6186a345fe','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:41',NULL,NULL,0),(13,5,'Kenneth','Macleod',NULL,'Kenneth','b253688c2f0a9a0f7aed3f5727ee8450573eefe2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:41',NULL,NULL,0),(14,5,'John','Purcell',NULL,'John','b110c1576f3bf8674a22e1ecb976261ead782b09','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:41',NULL,NULL,0),(15,5,'Edward','Thomas',NULL,'Edward','80317a3d21cd3da9d8c44f5f0ce2d3a89ce3170a','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:41',NULL,NULL,0),(16,5,'Claire','Burt',NULL,'Claire','f777ab670678e2022d009774573aecf15f5feaa9','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:41',NULL,NULL,0),(17,5,'Graham','Shand',NULL,'Graham','25cb1f4212ecd03586d4d74d1fc70ae8ae5425df','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:42',NULL,NULL,0),(18,5,'Doreen','McDonald',NULL,'Doreen','5598f65bf6837e71d5991477f81f190ec4f952fa','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:42',NULL,NULL,0),(19,5,'Margaret','Gray',NULL,'Margaret','533be9c0efd51fb4346eae98d6e228b8d5c83009','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:42',NULL,NULL,0),(20,5,'Sarah','Macaskill',NULL,'Sarah','64f799388ed2d38a8c339d8329c3e02725a5e986','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:42',NULL,NULL,0),(21,5,'Kathleen','Hoy',NULL,'Kathleen','932d72fb87258fbdb505795137833be8017c3c98','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:43',NULL,NULL,0),(22,5,'Michelle','Tosh',NULL,'Michelle','352b709d9cf3de87e86706fe12cc981ad6669dba','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:43',NULL,NULL,0),(23,5,'Kerry','Thorneycroft',NULL,'Kerry','dea242be79648c41e7ea032c3906dff6226245cc','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:43',NULL,NULL,0),(24,5,'Angus','Plumb',NULL,'Angus','12f2c7e726a5314ed990db124c72059212450be8','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:43',NULL,NULL,0),(25,5,'Sharon','Robb',NULL,'Sharon','1347d2ba5a4bd4ad7438644170b39ff4d70e25e5','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:43',NULL,NULL,0),(26,5,'Shelagh','Johnstone',NULL,'Shelagh','e0cd3878ad97d498e2fbbe24368ce72a36b8e3a1','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:44',NULL,NULL,0),(27,5,'Alan','Buck',NULL,'Alan','fb57c7dc3e298e075933c4d87ad9ced9bfd59a01','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:44',NULL,NULL,0),(28,5,'Sinclair','Laing',NULL,'Sinclair','8a71bfbcd926020b27e5ca8bc48fee1027fa08f2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:44',NULL,NULL,0),(29,5,'Irene','Pace',NULL,'Irene','e7a1d2931cfbaa10ca719e5c80e71362d0f5a9ee','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:44',NULL,NULL,0),(30,5,'Jacqueline','Gordon',NULL,'Jacqueline','6235ee60caf86dc17dc3a84ff5627fcb57c58d1b','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:44',NULL,NULL,0),(31,5,'Patricia','Brown',NULL,'Patricia','d91478b548190212cea572f115097e6e96617c15','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:45',NULL,NULL,0),(32,5,'Sheena','Davidson',NULL,'Sheena','6a49b0c99d5fa0e9da5a6b6cba2fa4ff1700f44a','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:45',NULL,NULL,0),(33,5,'Louise','Hough',NULL,'Louise','2c20593f41bb65be7760ccdbc56bb05b4b9e282f','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:45',NULL,NULL,0),(34,5,'Graham','Stubbins',NULL,'Graham','2dd052a0f97b2e7d3026a6b60ae5d64ebe5bac34','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:45',NULL,NULL,0),(35,5,'Linda','Mason',NULL,'Linda','834a091e149857bded06d4e36ee67205d1ebdc3e','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:46',NULL,NULL,0),(36,5,'Martin','Duguid',NULL,'Martin','fc945ff997378bbb79a6ed9e379bd8a37c4e7146','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:46',NULL,NULL,0),(37,5,'Peter','Twine',NULL,'Peter','6d320bace4210b375d62ed115e3ff951cf5cf6c0','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:46',NULL,NULL,0),(38,5,'David','Wilson',NULL,'David','647aecf9125b5482640e8984a510149dfa8c8564','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:46',NULL,NULL,0),(39,5,'Morag','Barclay',NULL,'Morag','effe200db2860f5e484ed97e52a1f56fbfa17290','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:47',NULL,NULL,0),(40,5,'Christine','Wilson',NULL,'Christine','c9a2ff9cc2f9bd2678fb40bad1e55aff11d82e34','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:47',NULL,NULL,0),(41,5,'Alastair','Condie',NULL,'Alastair','b0feda22f0056ab8441b7fd843d6fab45d298e35','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:47',NULL,NULL,0),(42,5,'Helen','Elliot',NULL,'Helen','577e30597941d8cc542a4b37514ce0a225681965','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:47',NULL,NULL,0),(43,5,'Derek','Beverley',NULL,'Derek','e3b33e7cbbecde2ab7e89b364d746250eefcf262','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:47',NULL,NULL,0),(44,5,'Joanna','McRae',NULL,'Joanna','a800901faefdb193c62a155dad80e3fdc2471424','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:48',NULL,NULL,0),(45,5,'Brian','Dow',NULL,'Brian','3e45eaabb68b6729278880c2f77434b2b5813b18','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:48',NULL,NULL,0),(46,5,'Neal','Murray',NULL,'Neal','de0b4640d54c5dd43a09f137f54bcb081c34b946','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:48',NULL,NULL,0),(47,5,'Ian','Sutherland',NULL,'Ian','20c3ddaf8de4ddf73a8e9e547a529de984b8028a','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:49',NULL,NULL,0),(48,5,'Susan','Caroline',NULL,'Susan','5d4bb773c1b3a52e350cfadcd682c3ee96092057','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:49',NULL,NULL,0),(49,5,'Robert','Morrison',NULL,'Robert','0c17a2abf16c11b8c66b8cd9966e12edec5a60cb','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:50',NULL,NULL,0),(50,5,'Bruce ','Strachan',NULL,'Bruce ','71c07b0c805d0a11b740f191c08c65bdc50a58cd','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:51',NULL,NULL,0),(51,5,'Sharon','Wren',NULL,'Sharon','f2fdd27c765b2e64dc71831bc2de125a3046ca1c','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:51',NULL,NULL,0),(52,5,'Ronnie','Fisher',NULL,'Ronnie','c82ee9eb44b2d0a12fbe88123b0dc8f4fca8fbfe','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:52',NULL,NULL,0),(53,5,'Valerie','Rae',NULL,'Valerie','6b93f35cdb6e1373775bacf6fd6a3f9782d01b97','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:52',NULL,NULL,0),(54,5,'Alan','Barclay',NULL,'Alan','9e47bd7dda4073f5143da47f942748a4d8057e2b','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:52',NULL,NULL,0),(55,5,'Stuart','Reid',NULL,'Stuart','fa6cc9e1de35890060977aee643e5228c1c48761','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:53',NULL,NULL,0),(56,5,'Martin','Murchie',NULL,'Martin','71a39b5fb07b2963903c7cb277256ef1bb38a913','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:53',NULL,NULL,0),(57,5,'Louise','Beaton',NULL,'Louise','6959ba8ad77dd89c64016f2762cbfddc61377432','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:53',NULL,NULL,0),(58,5,'Lesley','Strachan',NULL,'Lesley','4db409c40b7d33bd83ddb405254b3b865c828f6d','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:53',NULL,NULL,0),(59,5,'Jill','Forbes',NULL,'Jill','816a598a68f0698306eee7adde9f236c053bcfe6','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:54',NULL,NULL,0),(60,5,'Alan','Wilson',NULL,'Alan','e6d5b1c1b575369a4bcbbd62de9cf287570903fd','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:54',NULL,NULL,0),(61,5,'Alice','Mutch',NULL,'Alice','7129c6e86ae42e0a699061ea2e2d169fe487a099','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:54',NULL,NULL,0),(62,5,'Paul','Connolly',NULL,'Paul','37c358ef8082cccce2f584e5a2dfb5aaf9473781','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:54',NULL,NULL,0),(63,5,'Evelyn','Currie',NULL,'Evelyn','f65d28eca234b880b3102da486ad22637a10742a','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:54',NULL,NULL,0),(64,5,'Alan','Towns',NULL,'Alan','bf6a2a1f62ccdf188690cad363492deaf24023eb','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:55',NULL,NULL,0),(65,5,'Esther','Walterson',NULL,'Esther','5b813194a7fa673b6fa109071e0f3aaf90fba644','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:55',NULL,NULL,0),(66,5,'Lynn','Healey',NULL,'Lynn','31d78f303cac2e7b89a7ceb79d10b7955c5dea09','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:55',NULL,NULL,0),(67,5,'Charles','Walker',NULL,'Charles','aa399cb97db663ea722aad01d77938880ce0acc5','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:55',NULL,NULL,0),(68,5,'Kirsty','Jarman',NULL,'Kirsty','8b246d095b4ecbe48d0106d133f0170f191a5acf','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:56',NULL,NULL,0),(69,5,'William','Michie',NULL,'William','214ca69601ac97e4ed21d878b60f10739cf2e94f','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:56',NULL,NULL,0),(70,5,'Kenny ','Luke',NULL,'Kenny ','27b78432436ef42f4788190e779d3304c35c0da7','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:56',NULL,NULL,0),(71,5,'Stephen','Pirie',NULL,'Stephen','060d6395aefffe152b0f187631c07237339b4f38','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:56',NULL,NULL,0),(72,5,'Kim','Menzies',NULL,'Kim','a3f1745306ac25c06b089d1a5f40af42c8c7e1f1','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-02-03 04:41:56',NULL,NULL,0),(73,6,'Aaron','Percival','sdonaghy@moderndemocracy.com','apercival','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL','','2012-01-01','M','','en-GB',1,NULL,NULL,'2016-02-05 10:20:22',NULL,NULL,0),(74,6,'Barbara','Jeffries','sdonaghy@moderndemocracy.com','bjeffries','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL','','2012-01-01','M','','en-GB',1,NULL,NULL,'2016-02-05 10:20:54',NULL,NULL,0),(76,6,'Mat','Bloxham','sdonaghy@moderndemocracy.com','mbloxham','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL','','2012-01-01','M','','en-GB',1,NULL,NULL,'2016-02-05 10:21:40',NULL,NULL,0),(77,6,'Lesley','Blue','sdonaghy@moderndemocracy.com','lblue','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL','','2012-01-01','M','','en-GB',1,NULL,NULL,'2016-02-05 10:22:03',NULL,NULL,0),(78,6,'MDL','User','slappin@moderndemocracy.com','mdluser','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,'2012-01-01','M',NULL,'en-GB',1,NULL,NULL,'2016-02-17 10:22:03',NULL,NULL,0),(83,9,'MDL','User1','slappin@moderndemocracy.com','mdluser1','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,'2012-01-01','M',NULL,'en-GB',1,NULL,NULL,'2016-02-17 10:22:03',NULL,NULL,0),(84,9,'MDL','User2','slappin@moderndemocracy.com','mdluser2','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,'2012-01-01','M',NULL,'en-GB',1,NULL,NULL,'2016-02-17 10:22:03',NULL,NULL,0),(85,9,'MDL','User3','slappin@moderndemocracy.com','mdluser3','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,'2012-01-01','M',NULL,'en-GB',1,NULL,NULL,'2016-02-17 10:22:03',NULL,NULL,0),(86,10,'adm',' ',NULL,'adm','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-18 19:37:17',NULL,'/data/media/profile.jpg',0),(87,10,'Sandra','Bruce',NULL,'Bru','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-18 19:49:44',NULL,'/data/media/profile.jpg',0),(88,10,'Carol','Forbes',NULL,'For','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-18 19:49:44',NULL,'/data/media/profile.jpg',0),(89,10,'Stirling','Gow',NULL,'Gows','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-18 19:49:44',NULL,'/data/media/profile.jpg',0),(90,10,'Karen','McDonald',NULL,'McD','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-18 19:49:44',NULL,'/data/media/profile.jpg',0),(102,12,'administrator',' ',NULL,'administrator','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:53:17',NULL,'/data/media/profile.jpg',0),(103,12,'Sandra','Bruce',NULL,'Bruce','28c9894a6fa5379f0aa641237a9ba5467e81e9b6','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:55:20',NULL,'/data/media/profile.jpg',0),(104,12,'Carol','Forbes',NULL,'Forbes','65ad6820478148806d28d04bf274ee0eb16f6e1c','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:55:20',NULL,'/data/media/profile.jpg',0),(105,12,'Stirling','Gow',NULL,'Gow','d5e146d1426387b0004985d96ec9d89375ccd4ea','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:55:20',NULL,'/data/media/profile.jpg',0),(106,12,'Karen','McDonald',NULL,'McDonald','2f98571df75624ae75bf90f2e5b5394ef7c1649d','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:55:20',NULL,'/data/media/profile.jpg',0),(107,12,'Peter','Twine',NULL,'Twine','7637fbf8702740e94d509a234c6a2284afdac0ab','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:57:21',NULL,'/data/media/profile.jpg',0),(108,12,'Morag','Barclay',NULL,'Barclay','775d1e3f03101684e6d64264c8b6949f342c8299','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:57:21',NULL,'/data/media/profile.jpg',0),(109,12,'Stuart','Reid',NULL,'Reid','90a58bf02a6acc66461f31666ab3af464ae90153','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:57:21',NULL,'/data/media/profile.jpg',0),(110,12,'Irene','Pace',NULL,'Pace','9ae0dd20f5ef5a7f8e8b5822645101050328caca','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:57:21',NULL,'/data/media/profile.jpg',0),(111,12,'Martin','Murchie',NULL,'Murchie','465ad0b6dc06b16e415cd55f2c222be78f4add8a','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:57:21',NULL,'/data/media/profile.jpg',0),(112,12,'Graham','Shand',NULL,'Shand','cbb1940dc0f32ca1f13256ce15af6229619130e1','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-22 11:57:21',NULL,'/data/media/profile.jpg',0),(113,12,'sd2e.121','tt','12321@1212.comssds','sdsadas','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-03-29 07:27:54','2016-03-29 07:29:01','/data/media/profile.jpg',1),(114,12,'user','test 1','utest1@mail.com','psm 10','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-03-29 11:57:43',NULL,'/data/media/profile.jpg',0),(115,12,'user','test 1','utest1@mail.com','psm10','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-03-29 12:00:00',NULL,'/data/media/profile.jpg',0),(116,12,'rety','test','rety@test.com','em','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-03-29 12:07:33',NULL,'/data/media/profile.jpg',0),(117,12,'test','user 3','test@test3.com','gimi gimii','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-03-29 12:08:47','2016-03-29 16:54:01','/data/media/profile.jpg',0),(118,12,'yami 1','yashi','yshi@mail.com','yami','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-03-29 17:16:28','2016-03-29 17:18:24','/data/media/profile.jpg',0),(119,12,'wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww','yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy','y@ma.com','wy','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-03-29 17:17:01',NULL,'/data/media/profile.jpg',1),(120,12,'User','Test','UserTest@email.com','UsrTest','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'2016-03-30 13:30:45',NULL,'/data/media/profile.jpg',1),(121,13,'admin',' ',NULL,'admin','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-31 17:25:30',NULL,'/data/media/profile.jpg',0),(122,13,'Sandra','Bruce',NULL,'Bruce','28c9894a6fa5379f0aa641237a9ba5467e81e9b6','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-31 17:30:26',NULL,'/data/media/profile.jpg',0),(123,14,'admin',' ',NULL,'admin','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-31 21:46:35',NULL,'/data/media/profile.jpg',0),(124,14,'Sandra','Bruce',NULL,'Bruce','28c9894a6fa5379f0aa641237a9ba5467e81e9b6','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-03-31 21:57:38',NULL,'/data/media/profile.jpg',0),(125,15,'admin',' ',NULL,'admin','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-04-01 05:21:08',NULL,'/data/media/profile.jpg',0),(126,16,'administrator3',' ',NULL,'administrator3','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-04-01 06:34:14',NULL,'/data/media/profile.jpg',0),(127,17,'administrator4',' ',NULL,'administrator4','4ff00acf9d9ed8147ba301263946a0a572bc0fb2','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-04-01 06:40:34',NULL,'/data/media/profile.jpg',0),(128,16,'Sandra','Bruce',NULL,'star','28c9894a6fa5379f0aa641237a9ba5467e81e9b6','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-04-01 06:46:03',NULL,'/data/media/profile.jpg',0),(129,15,'William','Michie',NULL,'William','5ec94b96c2b00732f520bca92685a33f5ba291ea','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-04-01 08:15:50',NULL,'/data/media/profile.jpg',0),(130,15,'Wind','Will',NULL,'Wind','499fadc02e7bddacb041efdbf59ecc6ca5286cf5','S@l+VaL',NULL,NULL,NULL,NULL,'en-GB',1,NULL,NULL,'2016-04-01 08:15:50',NULL,'/data/media/profile.jpg',0);
/*!40000 ALTER TABLE `user` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user_role`
--

DROP TABLE IF EXISTS `user_role`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `user_role` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `organization_id` int(11) NOT NULL,
  `role_id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `user_role_fk1_idx` (`role_id`),
  KEY `user_role_fk2_idx` (`user_id`),
  KEY `user_role_fk3_idx` (`organization_id`),
  CONSTRAINT `user_role_fk1` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `user_role_fk2` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `user_role_fk3` FOREIGN KEY (`organization_id`) REFERENCES `subscription`.`organization` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=201 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user_role`
--

LOCK TABLES `user_role` WRITE;
/*!40000 ALTER TABLE `user_role` DISABLE KEYS */;
INSERT INTO `user_role` VALUES (3,2,1,2),(4,2,1,5),(5,2,1,6),(6,3,2,7),(7,4,3,8),(8,6,16,73),(9,6,17,74),(11,6,18,76),(12,6,18,77),(13,6,18,78),(18,9,25,83),(19,9,26,84),(20,9,25,85),(21,10,27,86),(22,10,28,87),(23,10,28,88),(24,10,28,89),(25,10,28,89),(26,10,28,90),(27,10,28,90),(28,10,28,87),(29,10,28,88),(30,10,28,89),(31,10,28,89),(32,10,28,90),(33,10,28,90),(57,12,40,102),(58,12,38,103),(59,12,38,104),(60,12,38,105),(61,12,38,105),(62,12,38,106),(63,12,38,106),(64,12,38,107),(65,12,38,108),(66,12,38,108),(67,12,38,109),(68,12,38,110),(69,12,38,110),(70,12,38,111),(71,12,38,111),(72,12,38,112),(73,12,38,112),(74,12,38,103),(75,12,38,104),(76,12,38,105),(77,12,38,105),(78,12,38,106),(79,12,38,106),(80,12,38,103),(81,12,38,104),(82,12,38,105),(83,12,38,105),(84,12,38,106),(85,12,38,106),(86,12,38,103),(87,12,38,104),(88,12,38,105),(89,12,38,105),(90,12,38,105),(91,12,38,106),(92,12,38,106),(93,12,38,107),(94,12,38,108),(95,12,38,108),(96,12,38,109),(97,12,38,110),(98,12,38,110),(99,12,38,111),(100,12,38,111),(101,12,38,112),(102,12,38,112),(103,12,38,107),(104,12,38,108),(105,12,38,108),(106,12,38,109),(107,12,38,110),(108,12,38,110),(109,12,38,111),(110,12,38,111),(111,12,38,112),(112,12,38,112),(113,12,38,103),(114,12,38,104),(115,12,38,105),(116,12,38,105),(117,12,38,106),(118,12,38,106),(119,12,38,107),(120,12,38,108),(121,12,38,108),(122,12,38,109),(123,12,38,110),(124,12,38,110),(125,12,38,111),(126,12,38,111),(127,12,38,112),(128,12,38,112),(129,12,38,103),(130,12,38,104),(131,12,38,105),(132,12,38,105),(133,12,38,106),(134,12,38,106),(135,12,38,103),(136,12,38,104),(137,12,38,105),(138,12,38,105),(139,12,38,106),(140,12,38,106),(141,12,38,103),(142,12,38,104),(143,12,38,105),(144,12,38,105),(145,12,38,105),(146,12,38,106),(147,12,38,106),(148,12,38,103),(149,12,38,104),(150,12,38,105),(151,12,38,105),(152,12,38,105),(153,12,38,106),(154,12,38,106),(155,13,54,121),(156,13,55,122),(157,13,55,122),(158,13,55,122),(159,13,55,122),(160,13,55,122),(161,13,55,122),(162,13,55,122),(163,13,55,122),(164,13,55,122),(165,13,55,122),(166,14,59,123),(167,14,60,124),(168,14,60,124),(169,14,60,124),(170,14,60,124),(171,12,38,103),(172,12,38,103),(173,12,38,103),(174,12,38,103),(175,15,64,125),(176,12,38,103),(177,12,38,103),(178,12,38,103),(179,12,38,103),(180,12,38,103),(181,12,38,103),(182,12,38,103),(183,12,38,103),(184,12,38,103),(185,12,38,103),(186,12,38,103),(187,12,38,103),(188,16,69,126),(189,17,74,127),(190,16,70,128),(191,16,70,128),(192,16,70,128),(193,16,70,128),(194,16,70,128),(195,16,70,128),(196,16,70,128),(197,16,70,128),(198,16,70,128),(199,16,70,128),(200,16,70,128);
/*!40000 ALTER TABLE `user_role` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping routines for database 'security'
--
/*!50003 DROP FUNCTION IF EXISTS `fn_validate_permission` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` FUNCTION `fn_validate_permission`( token VARCHAR(255),permission_code VARCHAR(255), app_name VARCHAR(255) ) RETURNS tinyint(1)
BEGIN

    DECLARE user VARCHAR(45);
    DECLARE orgcode VARCHAR(45);
    
    set user=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    
	if (select exists (
		select p.* 
		from security.user u inner join security.user_role ur on u.id = ur.user_id
		inner join security.role_permission rp on ur.role_id = rp.role_id
		inner join subscription.permission p on rp.permission_id = p.id
		inner join subscription.organization org on u.organization_id = org.id
        inner join subscription.application a on p.application_id = a.id
		where u.username = user and org.code = orgcode and 
        p.permissioncode = permission_code and a.name = app_name
	))
    then
		return 1;
    else
		return 0;
    end if;


END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `fn_validate_token` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` FUNCTION `fn_validate_token`( token VARCHAR(255) ) RETURNS tinyint(1)
BEGIN
/** break the token **/
    DECLARE user VARCHAR(45);
    DECLARE orgcode VARCHAR(45);
    DECLARE accesstoken VARCHAR(255);
    
    set user=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    
    
    /** check the token in the token table **/
    if (select exists(select * from security.access_token act inner join subscription.organization org on act.organization_id=org.id
    inner join security.user usr on act.userid=usr.id
    where org.code=orgcode and usr.username=user and act.token=token and
    now() >= act.fromdate and now() <= act.todate))
    then
		return 1;
    else
		return 0;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `SPLIT_STR` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `SPLIT_STR`(
x VARCHAR(255),
delim VARCHAR(12),
pos INT
) RETURNS varchar(255) CHARSET utf8
RETURN REPLACE(SUBSTRING(SUBSTRING_INDEX(x, delim, pos),
LENGTH(SUBSTRING_INDEX(x, delim, pos -1)) + 1),
delim, '') ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `addrole` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `addrole`(in token varchar(255),in rolename varchar(55),in description varchar(255))
BEGIN
	
    declare username varchar(45);
    declare orgcode varchar(45);
    declare orgid int;
    set username=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    
    set orgid=(select id from subscription.organization where code=orgcode);
    
    if (security.fn_validate_token(token)=1 ) then
		if(select exists(select * from security.role where name=rolename and organization_id=orgid)) then
			select 'Role already exists' as response;
        else
			insert into security.role (organization_id,name,description) values (
            orgid,rolename,description);
            select 'success' as response;
        end if;
    else
		select 'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `adduser` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `adduser`(in token varchar(255),in firstname varchar(127),in lastname varchar(127),
in email varchar(127),in username varchar(127),in passwordhash varchar(127),in passwordsalt varchar(127),in language_id int)
BEGIN
	
    declare usersname varchar(45);
    declare orgcode varchar(45);
    declare orgid int;
    set usersname=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    
    set orgid=(select id from subscription.organization where code=orgcode);
    
    if (security.fn_validate_token(token)=1 ) then
		if(select exists(select * from security.user usr where usr.username=username and usr.organization_id=orgid)) then
			select 'dataduplicate' as response;
        else
			insert into security.user (organization_id,firstname,lastname,email,username,passwordhash,passwordsalt,language_id) 
            values (orgid,firstname,lastname,email,username,passwordhash,passwordsalt,language_id);
            select 'success' as response;
        end if;
    else
		select 'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `create_token` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `create_token`(IN username VARCHAR(45),IN orgcode VARCHAR(45),IN token VARCHAR(500))
BEGIN
	insert into security.access_token (organization_id,userid,token,fromdate,todate)
    select o.id,u.id,token,now(),(now() + INTERVAL 1 DAY) from 
    subscription.organization o inner join security.user u on u.organization_id=o.id
    where u.username=username and o.code=orgcode;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `deleterole` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `deleterole`(in token varchar(255),in deleteroleid int,in alterroleid int)
BEGIN
	declare username varchar(45);
    declare orgcode varchar(45);
    declare orgid int;
    
    DECLARE EXIT HANDLER FOR SQLEXCEPTION 
    BEGIN          
          ROLLBACK;
          select 'error deleting Role' as response;
    END;
    
    set username=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    
    set orgid=(select id from subscription.organization where code=orgcode);

    if (security.fn_validate_token(token)=1 ) then		
		START TRANSACTION;
			update security.user_role set role_id=alterroleid where 
			role_id=deleteroleid and organization_id=orgid;
            
            update security.role_permission set role_id=alterroleid where
            role_id=deleteroleid and organization_id=orgid;
            
            delete from security.role where id=deleteroleid;
		COMMIT;
        select 'success' as response;
    else
		select 'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `deleteuser` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `deleteuser`(in token varchar(255),in usrid int)
BEGIN
	declare spcode varchar(45);
    declare username varchar(45);
    declare orgcode varchar(45);
    declare orgid int(11);
    declare userid int(11);
    
    set username=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    set spcode = 'deleteuser';
    select id into orgid from subscription.organization where code = orgcode;
    
    if (security.fn_validate_token(token)=1 ) then
		/*#delete from child tables
        
        #psm
        #psm.chat
        delete from psm.chat where userid=usrid and organizationid=orgid;
        
        #psm.issue
        delete from psm.issue where reportedby=username and organization_id=orgid;
        
        #psm.issue_assignment
        delete from psm.issue_assignment where user_id=usrid and organization_id=orgid;
        
        #psm.issue_comment
        delete from psm.issue_comment where user_id=usrid and organization_id=orgid;
        
        #psm.notification_status
        delete from psm.notification_status where userid=usrid and organization_id=orgid;
        
        #psm.user_election
        delete from psm.user_election where user_id=usrid and organization_id=orgid;
        
        #psm.voter_list
        delete from psm.voter_list where userid=usrid and organizationid=orgid;
        
        #security
        #security.access_token
        delete from security.access_token where userid=usrid and organization_id=orgid;
        
        #security.user_role
        delete from security.user_role where user_id=usrid and organization_id=orgid;
        
        #delete from parent table user
        delete from security.user where id=usrid and organization_id=orgid;*/
        
        update security.user usr set usr.is_deleted=1 where usr.id=usrid; 
        
		select 'success' as response;
    else
		select 'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `getallroles` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `getallroles`(in token varchar(255))
BEGIN
	declare spcode varchar(45);
    declare username varchar(45);
    declare orgcode varchar(45);
    declare orgid int;
    set spcode='getallroles';
    set username=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    set orgid=(select id from subscription.organization where code=orgcode);
    
    
    
    
    if (security.fn_validate_token(token)=1 and security.fn_validate_permission(token,spcode,'ADMIN')) then
		select id,name,description,'success' as response from security.role where organization_id=orgid;
    else
		select null as id,null as name,null as description,'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `getallusers` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `getallusers`(in token varchar(255))
BEGIN
	declare spcode varchar(45);
    declare orgcode varchar(45);
    declare orgid int;
    
    set spcode='getallusers';
    
    set orgcode=security.SPLIT_STR(token,'|',2);
    
    
    if (security.fn_validate_token(token)=1 and security.fn_validate_permission(token,spcode,'PSM')) then
		select id into orgid from subscription.organization where code=orgcode;
        select id as id,firstname as firstname,lastname as lastname,concat(firstname , ' ' ,lastname) as fullname,
        email as email,username as username,is_deleted as is_deleted,
        'success' as response from security.user where organization_id=orgid and is_deleted!=1;
	else
		select null as id,null as firstname,null as lastname,null as fullname,null as email,null as username,null as is_deleted,'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `getallusersbyissueid` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `getallusersbyissueid`(in token varchar(255), in issueid int)
BEGIN
	declare spcode varchar(45);
    declare usersname varchar(45);
    declare orgcode varchar(45);
    declare orgid int;
    declare repoter varchar(45);
    
    set spcode='getallusers';
    
    set usersname=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    select reportedby into repoter from psm.issue where id=issueid;
    
    if (security.fn_validate_token(token)=1 and security.fn_validate_permission(token,spcode,'PSM')) then
		select id into orgid from subscription.organization where code=orgcode;
        select id,firstname,lastname,concat(firstname , ' ' ,lastname) as fullname,email,username,
        'success' as response 
		from security.user where organization_id=orgid and !(username = repoter) and is_deleted=0;
	else
		select null as id,null as firstname,null as lastname,null as fullname,null as email,null as username,'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `getrolebyid` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `getrolebyid`(in token varchar(255),in roleid int)
BEGIN
	
    declare username varchar(45);
    declare orgcode varchar(45);
    declare orgid int;
    set username=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    
    set orgid=(select id from subscription.organization where code=orgcode);
    
    if (security.fn_validate_token(token)=1 ) then
		select id,name,description,'success' as response from security.role where id=roleid and organization_id=orgid;
    else
		select null as id,null as name,null as description,'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `getuserbyid` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `getuserbyid`(in token varchar(255),in userid int)
BEGIN        
    if (security.fn_validate_token(token)=1 ) then
		select firstname,lastname,IFNULL(email,'') as email,username,gender,'success' as response from security.user where id=userid;
    else
		select null as firstname,null as lastname,null as email,null as username,null as gender,'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `login` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `login`(IN username VARCHAR(45),IN orgcode VARCHAR(45),IN usersecret VARCHAR(45))
BEGIN
	DECLARE vartoken VARCHAR(500) DEFAULT NULL;
    DECLARE result VARCHAR(500);
	/** check the user in the given organization **/
    if (select exists (
		select * from security.user u inner join subscription.organization o on
		u.organization_id=o.id where 
		 o.code=orgcode and u.username=username and u.passwordhash=sha1(CONCAT(u.passwordsalt,usersecret))
         and u.is_deleted = 0
    )) then
		/** user is vlid. check whether there is an issued token **/
        select a.token into vartoken from security.access_token a inner join subscription.organization b on
        a.organization_id=b.id inner join
        security.user c on a.userid=c.id where b.code=orgcode and c.username=username and 
        now() >= a.fromdate and now() <= a.todate;
        
        if(vartoken is null ) then
			/** issue a new token here **/
            set result=concat(username,'|',orgcode,'|', MD5(RAND()));
            /** create with validity of a day **/
            call security.create_token(username,orgcode,result);
        else
			set result=vartoken;
        end if;
    else
		set result='unauthorized';
    end if;
    
    select result as response;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `login1` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `login1`(IN username VARCHAR(45),IN orgcode VARCHAR(45),IN usersecret VARCHAR(45))
BEGIN
	DECLARE vartoken VARCHAR(500) DEFAULT NULL;
    DECLARE result VARCHAR(500);
	/** check the user in the given organization **/
    if (select exists (
		select * from security.user u inner join subscription.organization o on
		u.organization_id=o.id where 
		u.username=username and u.passwordhash=sha1(CONCAT(u.passwordsalt,usersecret)) and o.code=orgcode
    )) then
		/** user is vlid. check whether there is an issued token **/
        select a.token into vartoken from security.access_token a inner join subscription.organization b on
        a.organization_id=b.id inner join
        security.user c on a.userid=c.id where b.code=orgcode and c.username=username and 
        now() >= a.fromdate and now() <= a.todate;
        
        if(vartoken is null ) then
			/** issue a new token here **/
            set result=concat(username,'|',orgcode,'|', MD5(RAND()));
            /** create with validity of a day **/
            call security.create_token(username,orgcode,result);
        else
			set result=vartoken;
        end if;
    else
		set result='unauthorized';
    end if;
    
    select result as response;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `updaterole` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `updaterole`(in token varchar(255),in roleid int,in rolename varchar(55),in description varchar(255))
BEGIN
	
    declare username varchar(45);
    declare orgcode varchar(45);
    declare orgid int;
    set username=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    
    set orgid=(select id from subscription.organization where code=orgcode);
    
    if (security.fn_validate_token(token)=1 ) then
		update security.role set name=rolename,description=description,updatedon=current_timestamp where
        organization_id=orgid and id=roleid;
        
		select 'success' as response;
    else
		select 'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `updateuser` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `updateuser`(in token varchar(255),in userid int,in firstname varchar(127),
in lastname varchar(127),in email varchar(127),in username varchar(127))
BEGIN
    
    if (security.fn_validate_token(token)=1 ) then
		update security.user usr set usr.firstname=firstname,
        usr.lastname=lastname,usr.email=email,usr.username=username,usr.updatedon=current_timestamp where
        usr.id=userid;        
		select 'success' as response;
    else
		select 'unauthorized' as response;
    end if;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `validate_token` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `validate_token`(IN token varchar(255))
BEGIN
	/** break the token **/
    DECLARE user VARCHAR(45);
    DECLARE orgcode VARCHAR(45);
    DECLARE accesstoken VARCHAR(255);
    
    set user=security.SPLIT_STR(token,'|',1);
    set orgcode=security.SPLIT_STR(token,'|',2);
    set accesstoken=security.SPLIT_STR(token,'|',3);
    
    /** check the token in the token table **/
    if (select exists(select * from security.access_token act inner join subscription.organization org on act.organization_id=org.id
    inner join security.user usr on act.userid=usr.id
    where org.code=orgcode and usr.username=user and act.token=accesstoken and
    now() >= act.fromdate OR now() <= act.todate))
    then
		select 1;
    else
		select 0;
    end if;
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2016-04-01 17:39:43
